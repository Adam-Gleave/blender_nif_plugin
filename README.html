<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>The Blender NIF Scripts v1.5.6</title>
  <meta http-equiv="Content-Type"
 content="text/html; charset=ISO-8859-1" />
  <style type="text/css">
th { font-weight: bold; color: black; background: #D3DCE3}
h1 { text-align: center; color: black; background: #FF6600; }
h2 { text-align: center; color: black; background: #FFCC33; }
h3 { text-align: left; color: black; background: #FFCC66; }
a:link { text-decoration: none; color: #006699; background: transparent; }
a:visited { text-decoration: none; color: #006699; background: transparent; }
a:hover { text-decoration: underline; color: #DD6900; background: transparent; }
a:link.nav { color: #000000; background: transparent; }
a:visited.nav { color: #000000; background: transparent; }
a:hover.nav { color: #FF0000; background: transparent; }
.nav { color: #000000; background: transparent; }
  </style>
</head>
<body>
<h1>The Blender NIF Scripts v1.5.6</h1>
<h2>Contributors</h2>
<p>(in random order)</p>
<ul>
  <li>Brandano (scripts coder, original import script author)</li>
  <li>Amorilia (scripts coder, original export script author)</li>
  <li>Shon (Niflib author, scripts bugtesting)</li>
  <li>m4444x (scripts coder, also author of NifSkope)</li>
</ul>
<h3>We also thank...</h3>
<ul>
  <li>All modders that have reported bugs:
Sabregirl, y67_a, Fakku, readhead33445, DemonFire, lucifer,
NeOmega, Andysaurus, tekener, CuteUnit, periplaneta, Pekka, submarine, throttlekitty, devoluted, and
many, many others... (drop us a note if we forgot your name here)</li>
  <li>Mannon, who started all this!</li>
  <li>Taharez, for helping with the generated Python NIF
library, NIF
specs, helping out with the file format, and some debugging</li>
  <li>Brick, for NIF specs </li>
  <li>y67_a, for pointing out the fact that the script forgot
to export normals; and thereby opening the path to smoothing support</li>
  <li>PlayerX and klassobanieras, for decoding the
NiSkinPartition block which gave me so many troubles </li>
  <li>NeOmega, for confirming the first
successful Civilization IV export</li>
  <li>Campbell Barton (AKA Ideasman, Cambo) for making original
importer code clear
enough to be used as a learning resource</li>
  <li>Timothy Wakeham (AKA timmeh),&nbsp;to help with the way
the UV maps work in Blender</li>
  <li>Portions of the original importer were derived (through the
old tested method of cut'n paste) from the obj import script
obj_import.py: OBJ Import v0.9 by Campbell Barton (AKA Ideasman)</li>
  <li>The original importer file reading strategy was 'inspired'
by the NifToPoly
script included with the DAOC mapper, which used to be available at <a
 href="http://www.randomly.org/projects/mapper/">http://www.randomly.org/projects/mapper/</a>
and was written and is
copyright 2002 of Oliver Jowett. His domain and e-mail address are
however no longer reacheable. No part of the original code is included
here, as we use Niflib now. An updated version of the script is
included with the DAOC Mappergui application, available at <a
 href="http://nathrach.republicofnewhome.org/mappergui.html">http://nathrach.republicofnewhome.org/mappergui.html</a>
  </li>
</ul>
<h2>Release Notes</h2>
<h3>Important Remarks</h3>
<ul>
  <li>Your old nif_import and nif_export settings are deleted by
the windows installer. This avoids a number of very annoying problems
with invalid script config files: in some cases, you wouldn't be able
to edit the configuration anymore.</li>
  <li>To change the importer and exporter settings, go
to the scripts window in Blender, and select
Scripts-&gt;System-&gt;Scripts Config
Editor-&gt;Import/Export. Note that the scale correction
in the
export config is also used by the importer. Also, <strong>you'll need to
run the import &amp; export script at least once before the options show up.</strong>
This is a limitation of the native Blender config system.
Here are some <a href="http://niftools.sourceforge.net/forum/viewtopic.php?t=150">screenshots
to find the right menu</a>.</li>
  <li><strong>Make sure to check below for importer
&amp; exporter
known issues and workarounds.</strong> New ones come up on every
release.</li>
</ul>
<h3>Highlights of this Release</h3>
<ul>
  <li>Again just a bugfix release, no new functionality added since 1.4.5</li>
  <li>Oblivion support in the next version, honest.</li>
  <li>Fixed an issue with the export of multi-material meshes.</li>
  <li>Fixed an issue with the export of zero-weighted vertexes.</li>
</ul>
<h2>Support</h2>
<ul>
  <li><a href="http://niftools.sourceforge.net/wiki/index.php/Blender">
http://niftools.sourceforge.net/wiki/index.php/Blender</a></li>
  <li><a href="http://niftools.sourceforge.net/forum/">http://niftools.sourceforge.net/forum/</a></li>
</ul>
<h2>Installation</h2>
<h3>Requirements</h3>
<ul>
  <li><strong>You
must have <a href="http://www.blender.org/">Blender 2.41</a> or
higher</strong>; the scripts won't run on older versions
of Blender. It is recommended that you use the Blender .exe installer,
and not the Blender .zip.</li>
</ul>
<h3>Manual Install</h3>
<ul>
  <li><strong>If you installed Blender using the .exe installer, 
you're best off using the Blender NIF Scripts .exe 
installer.</strong> If you installed Blender from the .zip, then you 
should download the .zip and extract its contents in the 
Blender scripts directory. This is by default C:\Program Files\Blender
Foundation\Blender\.blender\scripts.
If you used the .zip, make sure
you don't have any niflib.py, niflib.dll, or niflib.pyc 
files in folders outside the Blender scripts directory.
Restart Blender, and the options to import and export
NIF files will appear in the File-Import and File-Export menu's. <em>Make
sure you
have no niflib.py or _niflib.dll or niflib.pyc files in any other folder!</em>
Especially, you should check the Blender scripts folder, and your Python folders
if you have Python installed.</li>
    </ul>
  </li>
</ul>
<h3>Using the Scripts with Morrowind</h3>
<ul>
  <li>If you wish to use Morrowind's textures in your models:
    <ul>
      <li>extract the contents of 'Morrowind.bsa' (and, if you
have the expansions, also 'Tribunal.bsa' and 'Bloodmoon.bsa') into
for instance 'c:\src\morrowind' (use <a
 href="http://www34.brinkster.com/ghostwheel/">BSAPACK</a>
or the <a href="http://www.thelys.org/toolsmisc.php?modders">BSA
Browser</a>; if you use the latter, make sure you copy the BSA files to
'c:\src\morrwind' before extracting them).</li>
      <li>convert all .dds files in 'c:\src\morrowind\textures'
to .tga files (for instance, using the
<a href="http://eliteforce2.filefront.com/file/DDS_Converter;29412">DDS
Converter 2.1</a>)</li>
    </ul>
  </li>
</ul>
<h3>Using the Scripts with Oblivion</h3>
<ul>
  <li>Oblivion support is still far from complete.
Basically, right now, the only thing you can do is export 20.0.0.4 models.
These exported models will however lack physics. Most of the NIF files
in Oblivion are of version 20.0.0.5 which aren't supported at all by the
version of Niflib used by the scripts.
The recommended method for creating
new meshes in Oblivion is via NifSkope and the .obj format. Check the
<a href="http://www.elderscrolls.com/forums/">TES forums</a> as well!</li>
  <li>If you wish to use the Oblivion textures in your models, you can unpack
the BSA files using <a href="http://www34.brinkster.com/ghostwheel/">Ghostwheel's TES4 BSA unpacker</a>.</li>
</ul>
<h2>Exporter Notes</h2>
<h3>Usage</h3>
<ul>
  <li>create meshes (and empties, if you like) in Blender:
    <ul>
      <li>IMPORTANT: if you wish to animate meshes without using
armatures and bones, then, when grouping, always make parent without
inverse (in Object Mode, use CTRL-SHIFT-P)</li>
    </ul>
  </li>
  <li>create armatures and bones for animation
    <ul>
      <li>either edit bone envelopes, and parent your meshes to
armatures with vertex groups; the vertex weights will be constructed
using the bone envelopes</li>
      <li>or, simply parent meshes to bones (armature must be
in pose mode)</li>
      <li>make sure the vertex weights are set properly: select
the armature, go to pose mode, and play with the bones; the mesh should
deform along the bones</li>
      <li>insert pose mode keys in different frames (press I to
insert key, and select Rot, Loc, or LocRot) to compose your animation</li>
    </ul>
  </li>
  <li>create UV coordinates (be sure to check the blender
manual for more details)
    <ul>
      <li>create seams (3D View, Edit Mode, select seam
vertices, CTRL-E) </li>
      <li>in the 3D View, UV Face Select Mode, select all
faces, press U-&gt;LSCM </li>
      <li>(optional) if you want to create your own texture: in
the UV/Image Editor, UVs-&gt;Save UV Face Layout, and process the
saved texture with your favorite 2D paint program </li>
    </ul>
  </li>
  <li>add materials to your meshes, and add one texture to each
material, with the following settings:
    <ul>
      <li>texture map input: UV </li>
      <li>texture map output: COL for diffuse map (base texture)</li>
    </ul>
  </li>
  <li>for each texture:
    <ul>
      <li>set texture type to 'Image' </li>
      <li>either load a texture from 'c:\src\morrowind\textures',
or put your custom texture in the 'C:\Program Files\Morrowind\Data
Files\Textures' folder, and load it from there. Note that Blender does
not read .dds files.</li>
      <li>although this is not recommended, textures can be
embedded by toggling the "packed" button next to the "Reload" button in
the Image tab</li>
    </ul>
  </li>
  <li>(optional) animate meshes and/or empty objects (press I
to insert key, and select Rot, Loc, or LocRot; for now, only location and
rotation channels are exported); define the animation groups in a text
buffer called 'Anim' (import a Morrowind creature to get a feeling for
how this works; so far we only
support Morrowind-type animations) </li>
  <li>(optional) to export vertex colors, turn on the
VCOL_PAINT flag in the material tab </li>
  <li>(optional) Hull your model in a simple so-called
collision
mesh, which defines where the player cannot walk through (most of
Morrowind's static models have a collision mesh, you can see them in
the TES CS pressing F4 in the render window). You may want to create it
to speed up collision detection (recommended for complex models), to
help the player walk over objects
such as stairs, or to allow the player to walk through certain parts of
your model such as spider webs.
    <ul>
      <li>create a mesh called
'RootCollisionNode' (object name, not datablock name)</li>
      <li>don't apply any
material to it </li>
    </ul>
  </li>
  <li>(optional) if you suspect that some of the faces of your
meshes are not convex, then you should let blender triangulate these
meshes (press CTRL-T in edit mode with all vertices selected), because
in that case, Blender's triangulation algorithm is less error prone
than the triangulation algorithm used in this script. </li>
  <li><strong>select the models that you wish to export</strong>,
and run this
script from the 'File-&gt;Export' menu. Note that the script looks
for unparented parents of the selected objects, and exports these root
objects along with all of their children, so you don't have to select
the whole model. </li>
</ul>
<h3>Limitations</h3>
<ul>
  <li>Particle effects, cameras, and lights are not exported. We
are working on it.</li>
  <li>Actions (for animation groups) are ignored. You should
define animation groups in text buffer called "Anim".</li>
</ul>
<h3>Known Issues and Workarounds </h3>
<ul>
  <li>Ambient and emit colors are obtained by multiplication
with the diffuse color.</li>
  <li>Blender double sided faces will be one sided in the NIF
file (workaround: duplicate faces, or even better, use NifSkope and add a NiStencilProperty).</li>
  <li>Export of directly animated meshes is buggy
unless
you parent without parent inverse
(CTRL-SHIFT-P). Workaround: don't animate meshes directly; instead,
parent meshes to the armature and animate the bones.</li>
  <li>Parenting meshes to bones is buggy unless the bind pose
coincides
with the current frame of animation. There's not much we can do about
it, this is due to a limitation in the Blender Python API.</li>
  <li>Non-uniformly scaled objects cannot be exported.
Workaround: apply size and rotation (CTRL-A). Unfortunately, this
workaround does not work on empties. </li>
</ul>
<h3>Old History</h3>
<p>(For recent history see the ChangeLog file)</p>
<ul>
  <li>0.0 (Jun 15): first try </li>
  <li>0.1 (Jun 20): fixed texture mapping, fixed
transformations,
improved error handling </li>
  <li>0.2 (Jun 30): export animation, transparency, multiple
materials per mesh </li>
  <li>0.3 (Aug 25): export normals (fixes lighting, thx y67_a),
niflib.py updated </li>
  <li>0.4 (Aug 28): support smoothing </li>
  <li>0.5 (Sep 26): support for non-textured objects,
optimization in trishapedata </li>
  <li>0.6 (Sep 27): support for uniformly scaled objects (fixes
compatibility problem with Brandano's import script), fixed emissive
and ambient colour </li>
  <li>0.7 (Sep 30): animation group support (contributed by
m4444x) </li>
  <li>0.7.1 (Oct 4): vertex color support (contributed by
m4444x) </li>
  <li>0.8 (Oct 12): code cleanup, moved to BSD license </li>
  <li>Newer versions: see ChangeLog file.</li>
</ul>
<h2>Importer Notes</h2>
<h3>Usage</h3>
<ul>
  <li>Launch the script, select the .NIF file you wish to
import,
and you are
set.</li>
  <li>Actually, no, that's not it if you also want to load the
textures.
Blender does not support the loading of .DDS textures, so in order to
load these you must provide an alternative file with the same filename,
but with the extension .TGA, .PNG, .BMP or .JPG. Also, selecting a base
folder for the textures has proved to be an impossible task, so the
script looks for them in the same folder as the .NIF file, or in
"..\Textures\[subdir\]*.*" if the NIF file resides in
"..\Meshes\[subdir\]*.*". This means that if your NIF file is, say,
"C:\Morrowind\Data
Files\Meshes\deadparrot.nif" and the texture is "C:\Morrowind\Data
Files\Textures\parrot\dead.dds" you should convert the texture and move
it to "C:\Morrowind\Data Files\Meshes\Textures\parrot\dead.tga". This
is also in order to keep the texture file path consistent on re-export.</li>
</ul>
<h3>Limitations</h3>
<ul>
  <li>The script doesn't import particle
effects, multiple
UV channels.... the list is too long. We are working on it.</li>
</ul>
<h3>Known Issues and Workarounds</h3>
<ul>
  <li>Objects that had originally multiple materials will get
imported
as seperate meshes. As a consequence, if you export them again they
cannot retain the original mesh name, which results in trouble when you
re-export rigged stuff such as clothing simply because Morrowind is
very picky about the names of nodes in rigged models: the engine must
know where to attach certain nodes in the structure, and it uses the
node name to do so. If you import rigged meshes with multiple
materials, you probably need NifSkope to sort things out on the
re-exported model.</li>
</ul>
<h3> Old History </h3>
<p> (For recent history see the ChangeLog file) </p>
<ul>
  <li>1.5a: fixed a bug where texture files with trailing null
characters would
crash the importer</li>
  <li>1.6a: changed the material handling, now doesn't generate
duplicate materials, changed the mesh creation method. Now it builds
hierarchical relations
generating empties as correspondences to NiNodes</li>
  <li>1.7a: got rid of a couple of matrix operations, now I
apply
the transforms to
the mesh container rather than to the vertices, so there is no data
loss. The root node is scaled down to 1/10th of the original size and
rotated
-90# along the Z axis, but this is the only change introduced by the
importer. Now not only all the hierarchies are stored, but the empties
that act
as grouping widgets are moved to the correct relative coordinates, so
we might start to think about animations.</li>
  <li>1.8a: I did some little optimization, fixed a few things.
Now the root node is no longer rotated along the Z axis, as I realized
that I completely forgot that I should apply his transform matrix to
the root node as well. It is only scaled down to 10% of the original
size, and as all his
children inherit this transformation the meshes are much easier to
handle. I have also added a much better support for textures and
materials,
that are now only parsed once and reused if identical (obtained from
the same node). I couldn't notice any speed improvement, because on my
machine the
import is pretty much istantaneous anyway, but I believe that this
wastes less memory.</li>
  <li>1.9a: Not published, it didn't really introduce much
change
to what was
already there.</li>
  <li>2.0a: Big things afoot, now I got bones! The script now
will load single or
multiple armatures, and build each armature's bone tree in the rest
position. The bone head position is correct, the tail is approximated
and the rotation is botched. The trouble is that Blender's bone API is
a little bit messy. Let's say very messy. The NIF bones store their
orientation and origin as a matrix relative
to the parent node, while in Blender all coordinates are relative to
the armature node. And on top of that while I have a getRestMatrix
method I don't have an equivalent setRestMatrix one. I am still working
on this, but I already have a couple of ideas on
what I can to to get these damn thing working properly. I still don't
have the skinning info, so moving the bones about won't
change the pose of the model. But if you want to help me out have a
look at the NiSkinInstance and NiSkinData nodes, NiSkinData in
particular. NiSkinInstance holds a list of bones that influence the
mesh, the class is already defined in the script, even though it isn't
used. In the smaller updates, if the script can't find a full Python
installation it will print a customized error showing the Python
version Blender was compiled with. This is not necessarily the Python
version you need, but is sure to work. At this time the correct version
is Python 2.3.5</li>
  <li>1.0.1: I took the occasion of a new Blender version out
and
changed my
versioning convention. Sorry about the confusion. Fixed a bug that
would hang the script on Blender 2.37. Now bones are 'a' proper length
(NIF bone systems don't report a bone
length), and are aligned properly, well, within 1 degree of their roll
position</li>
  <li>1.0.2: A few (quite a few actually) bugfixes by Amorilia
(whoopee, another
python coder onboard!). Now the script won't crash with larger NIFs.
And read the right number
of blocks. And won't overwrite existing meshes etc.. </li>
  <li>1.0.3: Added a new way to roll bones to their proper
position, might save a
few cycles, tho sometimes it still needs to approximate the result.
Changed the way the nif format is detected. The script now also detects
the file version and can test against a list of different file
versions. It also allows for longer headers, like in the case of "Zoo
Thycoon 2"
NIF files. Zoo Thycoon 2 files are way too different from Morrowind's
files to be
imported, though.</li>
  <li>1.0.4: Removed a bunch of debug messages to speed up
things
a little. Added vertex groups to the imported info, but the skinning
doesn't work
yet. To work properly both the meshes and the armature should share the
same coordinates system apparently, and the nested transformations that
are applied to both are making it very difficult to come up with a
working system. I really ran out of ideas, I am afraid. Meshes now are
imported as an "object" wrapped by a NiNode, and
therefore the outliner tree is a little simpler. This also loses a
little transform info, but nothing you will notice on the screen anyway
as the transform matrix of the NiNode and NiTriShape are combined while
importing.</li>
  <li>1.0.5: Fixed a few typos and a couple of mistakes that
Amorilia pointed out.
Still incomplete, by far, but seems to be approaching the "usable"
state.</li>
  <li>1.0.6: Added Amorilia's corrections to the import of UV
seams. Changed the
name of the file to reflect the fact that the importer is version
specific. As of this version the licensing is under a BSD license, to
avoid
confusion when distributing together with Amorilia's export script.
However, copyright on the two script is still with the respective
authors. Also, all previous versions of this script are still to be
considered
as governed by the GPL license. I also removed a small portion of the
readme regarding python setup, as
it was confusing, redundant and most likely just wrong. For the moment
I'll rely on the Blender's user forums, until I can come up with a
decent tutorial on setting up python properly.</li>
</ul>
<h2>License </h2>
<p> Copyright (c) 2005, <a href="http://niftools.sourceforge.net/">NIF
File Format
Library and Tools</a><br />
All rights reserved. </p>
<p> Redistribution and use in source and binary forms, with or
without modification, are permitted provided that the following
conditions are met: </p>
<ul>
  <li>Redistributions of source code must retain the above
copyright notice, this list of conditions and the following disclaimer.
  </li>
  <li>Redistributions in binary form must reproduce the above
copyright notice, this list of conditions and the following disclaimer
in the documentation and/or other materials provided with the
distribution. </li>
  <li>Neither the name of the NIF File Format Library and Tools
project nor the names of its contributors may be used to endorse or
promote products derived from this software without specific prior
written permission. </li>
</ul>
<p> THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND
CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING,
BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS
OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR
TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE
USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH
DAMAGE. </p>
</body>
</html>
